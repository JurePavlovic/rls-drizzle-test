meta {
  name: Login
  type: http
  seq: 1
}

post {
  url: {{SUPABASE_URL}}/auth/v1/token?grant_type=password
  body: json
  auth: inherit
}

params:query {
  grant_type: password
}

headers {
  apikey: {{API_KEY}}
}

body:json {
  {
      "email": "test-dev@email.com",
      "password": "Test123"
  }
}

script:post-response {
  bru.setEnvVar("AUTH_TOKEN", res.body.access_token);
}

settings {
  encodeUrl: true
}
